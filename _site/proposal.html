<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The Last Giants</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">The Last Giants</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./proposal.html" rel="" target="" aria-current="page">
 <span class="menu-text">Proposal</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./presentation.html" rel="" target="">
 <span class="menu-text">Presentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/INFO526-DataViz/project-final-Visual-Virtuosos" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dataset" id="toc-dataset" class="nav-link active" data-scroll-target="#dataset">Dataset</a></li>
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions">Questions</a></li>
  <li><a href="#analysis-plan" id="toc-analysis-plan" class="nav-link" data-scroll-target="#analysis-plan">Analysis plan</a>
  <ul class="collapse">
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  </ul></li>
  <li><a href="#plan-of-attack" id="toc-plan-of-attack" class="nav-link" data-scroll-target="#plan-of-attack">Plan of Attack</a></li>
  <li><a href="#repo-organization" id="toc-repo-organization" class="nav-link" data-scroll-target="#repo-organization">Repo Organization</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The Last Giants</h1>
<p class="subtitle lead">A data-driven safari into the savannah</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The goal of this project is to visualize the African savannah elephants’ population and the ivory trade in Africa.</p>
<p>The African savannah elephant, scientifically known as Loxodonta africana, stands at the brink of an existential crisis, as it grapples with the relentless threats of poaching and the encroachment of its natural habitats. Despite global efforts to address the dire situation facing these magnificent creatures, a veil of uncertainty shrouds our knowledge regarding their population sizes and trends across much of the African continent. The survival of these iconic giants is compromised by a multitude of poaching activities, including the tragic ivory trade, as well as rampant deforestation and the hunting of elephants for their prized tusks.</p>
<p>In response to this critical conservation challenge, we have undertaken a vital project aimed at unraveling the enigmatic population trends and distribution patterns of the savannah elephant throughout the years 1995-2023. Furthermore, our mission extends to comprehending the intricate web of ivory trade activities, which may offer invaluable insights into the potential consequences on the elephant population. By shedding light on these pressing issues, we strive to contribute to a better understanding of the complex dynamics between human activities, conservation efforts, and the survival of these majestic beings in the wild.</p>
<section id="dataset" class="level1">
<h1>Dataset</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installing necessary packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the dataset</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>elephant <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/dataset.xlsx"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#glimpse(elephant)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The research paper titled <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5012305/">“Continent-wide Survey: Massive Decline in African Savannah Elephants”</a> contains a dataset which is a collection of information on the African Savannah Elephants and spans over the years 1995 to 2014. This data file has been loaded to the <code>data</code> folder. This dataset has been meticulously compiled to track and document the population trends of African savannah elephants, a species that has been facing a severe decline in numbers during this time period.</p>
<p>This dataset contains a wealth of data points and variables that provide insights into various aspects of elephant populations, including their distribution across different regions of Africa, demographic information such as the ecosystem of the elephants. The dimensions of the dataset are 322 rows and 7 columns. The variables in the dataset and their description is presented as follows.</p>
<table class="table">
<colgroup>
<col style="width: 45%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th>Column</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Country</td>
<td>Name of the Country</td>
</tr>
<tr class="even">
<td>Ecosystem</td>
<td>Name of the ecosystem as used in the manuscript and supplemental material.</td>
</tr>
<tr class="odd">
<td>Stratum</td>
<td>Where the stratum name is the same as the ecosystem name, this indicates that the entire ecosytsem was the study area for the historical data. See Figure S7 for map of strata.</td>
</tr>
<tr class="even">
<td>Year</td>
<td>Year of survey</td>
</tr>
<tr class="odd">
<td>Estimate</td>
<td>Estimated number of elephants present</td>
</tr>
<tr class="even">
<td>SE</td>
<td>Standard error: 0 values indicate total counts; blank indicates missing value for a sample count.</td>
</tr>
<tr class="odd">
<td>Source</td>
<td>Source of data. “GEC report” indicates that data were taken from the GEC report for that ecosystem; most GEC reports are not publicly available.</td>
</tr>
</tbody>
</table>
<p>The ivory trade data was obtained from the <a href="https://cites.org/eng/prog/etis">Elephant Trade Information System (ETIS)</a>. The reports published in the website include country-wise ivory trade data from 2008-2019. The dimensions of the dataset are 88 rows and 12 columns. The variables in the data are, <code>country</code>, <code>year</code> and <code>total no. of seizure cases</code>.</p>
<table class="table">
<thead>
<tr class="header">
<th>Column</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Country</td>
<td>Name of the country</td>
</tr>
<tr class="even">
<td>Year</td>
<td>Years spanned from 2008-2019</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>Total no. of seizure cases</td>
</tr>
</tbody>
</table>
</section>
<section id="questions" class="level1">
<h1>Questions</h1>
<p>Q1. How has elephant population varied over the years across several African countries?</p>
<p>Q2. What is the trend of ivory trade in Africa?</p>
</section>
<section id="analysis-plan" class="level1">
<h1>Analysis plan</h1>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<p>The present dataset contains the data from 1995-2014. However, this data can be used to further predict the population of the elephants for the period 2015-2023. Hence, it is one of the important stages to predict the elephant population data from 2015-2023.</p>
<p>In the question, “How has elephant population varied over the years across several African countries?”, we are interested in understanding the distribution of the elephants. The important variables to be considered here are <code>country</code>, <code>estimate</code> and <code>year</code>. This task involves a well-structured analysis plan as presented below.</p>
<ul>
<li><p>Data Preprocessing:</p>
<ul>
<li>Clean and preprocess the data to ensure consistency and accuracy.</li>
<li>Handle missing values and outliers appropriately.</li>
</ul></li>
<li><p>Data Exploration:</p>
<ul>
<li>Perform initial exploratory data analysis to understand the dataset’s structure and characteristics.</li>
<li>Calculate basic statistics, visualize distributions, and identify trends or patterns in the data.</li>
</ul></li>
<li><p>Data prediction:</p>
<ul>
<li>Predict the data from 2015-2023 using multiple regression techniques like Ordinary Least squares, Polynomial regression, Lasso regression, Elastic net regression.</li>
</ul></li>
<li><p>Model Evaluation:</p>
<ul>
<li>Select the regression technique which provides the best-fit model.</li>
</ul></li>
<li><p>Country-Level Analysis:</p>
<ul>
<li>Group the data by country and region to analyze elephant populations in different areas of Africa.</li>
<li>Create map plots that illustrate population distribution using the package <code>rnaturalearth</code>, <code>sf</code> and <code>plotly</code></li>
<li>The <code>rayshader</code> package may also be used to implement a 3-D map plot.</li>
</ul></li>
<li><p>Shiny App Development which includes:</p>
<ul>
<li>Dynamic timeline for selecting the year of interest</li>
<li>Interactive maps of African countries with color-coded markers or chloropleths to represent elephant populations.</li>
</ul></li>
</ul>
</section>
<section id="question-2" class="level2">
<h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<p>To address the question “What is the trend of ivory trade in Africa?”, the following is a well-structured analysis plan as presented below.</p>
<ul>
<li><p>Data Preprocessing:</p>
<ul>
<li>Clean and preprocess the data to ensure consistency and accuracy.</li>
<li>Handle missing values and outliers appropriately.</li>
</ul></li>
<li><p>Data Exploration:</p>
<ul>
<li>Perform initial exploratory data analysis to understand the dataset’s structure and characteristics.</li>
<li>Calculate basic statistics, visualize distributions, and identify trends or patterns in the data.</li>
</ul></li>
<li><p>Data prediction:</p>
<ul>
<li>Predict the data from 2020-2023 using multiple regression techniques like Ordinary Least squares, Polynomial regression, Lasso regression, Elastic net regression.</li>
</ul></li>
<li><p>Model Evaluation:</p>
<ul>
<li>Select the regression technique which provides the best-fit model.</li>
</ul></li>
<li><p>Data Visualization:</p>
<ul>
<li>Visualize the trends ivory trade with a <code>timeseries plot.</code></li>
</ul></li>
</ul>
</section>
</section>
<section id="plan-of-attack" class="level1">
<h1>Plan of Attack</h1>
<table class="table">
<colgroup>
<col style="width: 31%">
<col style="width: 36%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Week</th>
<th style="text-align: center;">Weekly Tasks</th>
<th style="text-align: center;">Team members involved</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Till November 8<sup>th</sup></td>
<td style="text-align: center;">Explore and finalize the dataset and the problem statements</td>
<td style="text-align: center;">Everyone</td>
</tr>
<tr class="even">
<td style="text-align: center;">-</td>
<td style="text-align: center;">Complete the proposal and assign some high-level tasks</td>
<td style="text-align: center;">Everyone</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Nov.&nbsp;9<sup>th</sup> - 15<sup>th</sup></td>
<td style="text-align: center;">Understanding <code>rnaturalearth</code>, <code>sf</code> and <code>plotly</code> packages along with geospatial data</td>
<td style="text-align: center;">TBD</td>
</tr>
<tr class="even">
<td style="text-align: center;">-</td>
<td style="text-align: center;">Data Pre processing</td>
<td style="text-align: center;">TBD</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Nov.&nbsp;16<sup>th</sup> - 22<sup>nd</sup></td>
<td style="text-align: center;">Data prediction and Model Evaluation</td>
<td style="text-align: center;">TBD</td>
</tr>
<tr class="even">
<td style="text-align: center;">Nov.&nbsp;23<sup>rd</sup> - 29<sup>th</sup></td>
<td style="text-align: center;">Data visualisation</td>
<td style="text-align: center;">TBD</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-</td>
<td style="text-align: center;">Shiny app development</td>
<td style="text-align: center;">TBD</td>
</tr>
<tr class="even">
<td style="text-align: center;">Nov.&nbsp;30<sup>th</sup> - December 6<sup>th</sup></td>
<td style="text-align: center;">Review the code</td>
<td style="text-align: center;">Everyone</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Dec.&nbsp;7<sup>th</sup> - 13<sup>th</sup></td>
<td style="text-align: center;">Write-up and presentation for the project</td>
<td style="text-align: center;">Everyone</td>
</tr>
</tbody>
</table>
</section>
<section id="repo-organization" class="level1">
<h1>Repo Organization</h1>
<p>The following are the folders involved in the Project repository.</p>
<ul>
<li><p><strong>data/:</strong> Used for storing any necessary data files for the project, such as input files.</p></li>
<li><p><strong>images/:</strong> Used for storing image files used in the project.</p></li>
<li><p><strong>presentation_files/:</strong> Folder for having presentation related files.</p></li>
<li><p><strong>_extra/:</strong> Used to brainstorm our analysis which won’t impact our project workflow.</p></li>
<li><p><strong>_freeze/:</strong> This folder is used to store the generated files during the build process. These files represent the frozen state of the website at a specific point in time.</p></li>
<li><p><strong>_site/:</strong> Folder used to store the generated static website files after the site generator processes the quarto document.</p></li>
<li><p><strong>.github/:</strong> Folder for storing github templates and workflow.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>